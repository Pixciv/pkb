name: ðŸ—ï¸ Build APK

on:
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: ðŸ“¥ Repo klonla
      uses: actions/checkout@v3

    - name: ðŸ§° Gerekli paketleri kur (jq, imagemagick, openjdk)
      run: |
        sudo apt-get update
        sudo apt-get install -y jq imagemagick openjdk-17-jdk

    - name: â˜• Java versiyon kontrol
      run: java -version

    - name: ðŸ›¡ï¸ Gradle Wrapperâ€™a izin ver
      run: chmod +x ./gradlew

    - name: ðŸ› ï¸ Build scriptine izin ver
      run: chmod +x ./build.sh

    - name: ðŸš€ Build iÅŸlemini baÅŸlat
      run: ./build.sh

    - name: ðŸ§­ ðŸ”— Debug APK yolu alÄ±nÄ±yor
      id: debug
      run: echo "path=$(cat release-debug.txt)" >> $GITHUB_OUTPUT

    - name: ðŸ§­ ðŸ”— Release APK yolu alÄ±nÄ±yor
      id: release
      run: echo "path=$(cat release-release.txt)" >> $GITHUB_OUTPUT

    - name: ðŸ§­ ðŸ”— AAB dosya yolu alÄ±nÄ±yor
      id: aab
      run: echo "path=$(cat release-aab.txt)" >> $GITHUB_OUTPUT

    - name: ðŸ“¦ YÃ¼kle - Debug APK
      uses: actions/upload-artifact@v4
      with:
        name: debug-apk
        path: ${{ steps.debug.outputs.path }}

    - name: ðŸ“¦ YÃ¼kle - Release APK
      uses: actions/upload-artifact@v4
      with:
        name: release-apk
        path: ${{ steps.release.outputs.path }}

    - name: ðŸ“¦ YÃ¼kle - Release AAB
      uses: actions/upload-artifact@v4
      with:
        name: release-aab
        path: ${{ steps.aab.outputs.path }}
